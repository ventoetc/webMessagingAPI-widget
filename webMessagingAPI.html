<!doctype html>
<html lang="en">
<!--Create by matt as an example only
    connects to the Genesys Cloud WebMessaging API
    https://developer.genesys.cloud/api/digital/webmessaging/websocketapi
    -->

<head>
    <!-- Required meta tags -->
    <meta name="robots" content="noindex" />
    <!--Removes Google Crawler from indexing page-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="./webMessagingAPI.js" defer></script>
    <link rel="stylesheet" href="styles.css"/>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>webMessagingAPI</title>
</head>

<body>
    <h1 class="m-3">Welcome to the custom webMessagingAPI widget page</h1>
    <h5 class="m-3">ensure your url is like:
        "https://domain.com/webMessagingAPI.html?gc_region=mypurecloud.com.au&gc_deploymentId=ENTERID"</h5>
    <br>
    <br>
    <button type="button" class="m-3 btn btn-primary" onclick="clearToken()">Clear session token</button>
    <div style="display: flex;">
        <p class="m-3">Current token:</p>
        <p class="m-3" id="currentToken"></p>
    </div>
    <div style="display: flex;">
        <p class="m-3">Region:</p>
        <p class="m-3" id="region"></p>
    </div>
    <div style="display: flex;">
        <p class="m-3">Deployment:</p>
        <p class="m-3" id="deploymentId"></p>
    </div>

    <!--Emoji Picker-->
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 12">
        <div id="emojis" class="toast hide" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header justify-content-end" style="color: black;">Emoji Picker
                <button type="button" onclick="closeEmojis()" class="btn-close" data-bs-dismiss="toast"
                    aria-label="Close"></button>
            </div>
            <div class="toast-body">
                <div class="btn-group" style="flex-wrap: wrap;" role="group" aria-label="First group">
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😀</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😁</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😆</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😂</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😉</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😏</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😊</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😍</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😋</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😎</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😐</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😣</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😯</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😫</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😴</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😌</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😝</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😜</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😢</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😭</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😨</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😰</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😱</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😠</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😕</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">🙁</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😮</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😦</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😧</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😑</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😶</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😒</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😬</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😳</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😞</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😓</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😅</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😇</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😔</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😪</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">🥳</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">😷</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">👍</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">👎</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">👊</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">👋</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">👏</button>
                    <button type="button" class="btn btn-outline-secondary"
                        onclick="document.getElementById('message').value = document.getElementById('message').value + this.innerHTML">👌</button>
                </div>
            </div>
        </div>
    </div>
    </div>

    <!--floating chat button-->
    <div class="position-fixed bottom-0 end-0 p-5" style="max-width: 150px">
        <div id="chatButton" class="toast show" role="alert" aria-live="assertive" aria-atomic="true">
            <button type="button" class="btn btn-primary" style="width: 100%" onclick="openChat()">
                <img src="./docs/images/chatIcon.svg">
            </button>
        </div>
    </div>

    <!--floating chat widget-->
    <div class="position-fixed bottom-0 end-0 p-4" style="z-index: 11">
        <div id="widget" class="toast hide" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <img class="w-25 p-3" src="./docs/images/chatIcon.svg">
                <h3 class="me-auto" style="color: black;">Web Messaging</h3>
                <button type="button" class="m-2 btn btn-light btn-sm" onclick="closeChat()">
                    <img src="./docs/images/close.svg">
                </button>
            </div>
            <div class="progress" style="height: 3px;">
                <div class="progress-bar progress-bar-striped progress-bar-animated" id="progressbar" role="progressbar"
                    aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
            </div>
            <div class="toast-body">
                <div id="messages" class="container overflow-auto position-relative"
                    style="max-height: 40vh; min-height: 40vh"></div>
                <div class="mt-2 pt-2 border-top d-flex" style="height: 70px">
                    <input id="message" class="m-1 form-control" placeholder="Enter message..."
                        aria-label="message"></input>
                    <button type="button" class="m-1 btn btn-light btn-sm" id="emojiButton" onclick="openEmojis()">
                        <img src="./docs/images/emoji.svg">
                    </button>
                    <label type="button" class="m-1 btn btn-secondary btn-sm position-relative" style="width: 55px">
                        <img class="position-absolute top-50 start-50 translate-middle" src="./docs/images/image.svg">
                        <input class="form-control form-control-sm form-file-button-color-blue" id="formFileSm"
                            type="file" onchange="fileStatus()" hidden>
                    </label>
                    <button type="button" class="m-1 btn btn-success btn-sm" id="sendButton"
                        onclick="wssSend(document.getElementById('message').value)">
                        <img src="./docs/images/send.svg">
                    </button>
                </div>
                <div id="imageAttached" hidden>
                    <label id="imageAttachedName" class="m-1"></label>
                    <button type="button" class="m-1 btn-close" aria-label="Close" onclick="fileRemove()"></button>
                </div>
                <button id="endButton" onclick="endConversation()">End</button>

            </div>
        </div>
    </div>
</body>

</html>